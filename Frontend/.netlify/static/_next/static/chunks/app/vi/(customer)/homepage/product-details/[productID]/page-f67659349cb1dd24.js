(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3441],{43177:(e,t,r)=>{Promise.resolve().then(r.bind(r,48527))},48527:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>C});var n=r(95155),a=r(12115),i=r(35695),s=r(58966),c=r(75109),o=r(24932),l=r(17e3),d=r(36761),u=r(81891),m=r(84109),p=r(63356),h=r(26333),x=r(90192),g=r(43557),v=r(79030),f=r(423),y=r(25957),b=r(47599),j=r(41283),N=r(13568),w=r(89179),D=r(40872),I=r(84920),k=r(49189),A=r(10173);function C(){let{productID:e}=(0,i.useParams)(),{dictionary:t}=(0,j.K)(),{user:r}=(0,w.J)(),[C,S]=(0,a.useState)(null),[E,P]=(0,a.useState)(!0),[L,R]=(0,a.useState)([]),[B,_]=(0,a.useState)("description"),q=(0,a.useRef)(null),[O,T]=(0,a.useState)(!1),[z,F]=(0,a.useState)([]),[K,H]=(0,a.useState)([]),J=(0,c.hG)({extensions:[o.A,l.A,d.Ay,u.Ay,p.A,h.Ay.configure({nested:!0}),m.A.configure({types:["heading","paragraph"]}),x.Ay.configure({resizable:!0}),f.A,v.h,g.A],content:"<p>Đang tải...</p>",editable:!1,immediatelyRender:!1});(0,a.useEffect)(()=>{let e=()=>{q.current&&T(q.current.getBoundingClientRect().top<0)};return window.addEventListener("scroll",e,{passive:!0}),e(),()=>window.removeEventListener("scroll",e)},[]);let Q=async e=>{if(!r)return void N.oR.error("Bạn cần đăng nhập để tương t\xe1c với b\xecnh luận");try{await (0,k.tT)(e),Z()}catch(e){console.error("Error liking comment:",e),N.oR.error("Lỗi khi th\xedch b\xecnh luận.")}},W=async e=>{if(!r)return void N.oR.error("Bạn cần đăng nhập để tương t\xe1c với b\xecnh luận");try{await (0,k.Ph)(e),Z()}catch(e){console.error("Error disliking comment:",e),N.oR.error("Lỗi khi kh\xf4ng th\xedch b\xecnh luận.")}},Z=(0,a.useCallback)(async()=>{try{let t=await (0,k.Zg)(Number(e));Array.isArray(t)||R([]),R(t)}catch(e){R([]),console.error("Error fetching comments:",e)}},[e]);return((0,a.useEffect)(()=>{let t=async()=>{try{let t=await (0,A.eH)(e);if(!t)return void S(null);S(t),null==J||J.commands.setContent(JSON.parse(t.description))}catch(e){S(null),console.error("Error fetching product:",e)}finally{P(!1)}};e&&(t(),Z())},[e,J,Z]),(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,A.j0)();F(e)}catch(e){console.error("Error fetching products:",e)}})()},[]),(0,a.useEffect)(()=>{z.length&&(null==C?void 0:C.subcategoryID)&&H(z.filter(e=>e.subcategoryID===C.subcategoryID&&e.productID!==C.productID))},[z,null==C?void 0:C.subcategoryID,null==C?void 0:C.productID]),E)?(0,n.jsx)(y.cW,{}):C?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mx-auto py-8",children:[(0,n.jsx)("div",{className:"pb-6 px-6",children:(0,n.jsx)(y.Qp,{items:[{label:(null==t?void 0:t.navHomepage)||"Trang chủ",href:"/"},{label:C.productName}]})}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsx)(s.default,{productID:Number(e),productName:C.productName,rating:C.rating,productPrice:C.productPrice,productPriceSale:C.productPriceSale,quantityAvailable:C.quantityAvailable,sku:"SP".concat(C.productID),category:C.category,origin:C.origin,Tags:C.Tags,images:C.images}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{ref:q}),(0,n.jsxs)("div",{className:"relative w-full min-h-[400px] border-primary/20 border-1 rounded-lg mt-10",children:[(0,n.jsxs)("div",{className:"absolute -top-[30px] left-0 w-full space-x-2 flex justify-center",children:[(0,n.jsx)("button",{onClick:()=>_("description"),"data-currenttab":"description"===B?"description":void 0,"data-iscomments":"comments"===B?"comments":void 0,className:"px-6 py-4 bg-gray-200 rounded-full data-[currenttab=description]:text-white data-[currenttab=description]:bg-primary data-[isComments=comments]:hover:cursor-pointer border-5 border-white",children:"Chi tiết sản phẩm"}),(0,n.jsx)("button",{onClick:()=>_("comments"),"data-currenttab":"comments"===B?"comments":void 0,"data-isdiscription":"description"===B?"description":void 0,className:"px-6 py-4 bg-gray-200 rounded-full data-[currenttab=comments]:text-white data-[currenttab=comments]:bg-primary  data-[isDiscription=description]:hover:cursor-pointer border-5 border-white",children:"B\xecnh luận"})]}),(0,n.jsx)("div",{className:"w-full h-full mt-[50px] px-6 ",children:"description"===B?(0,n.jsx)("div",{className:"prose prose-blue max-w-none tiptap-content mb-8",children:(null==C?void 0:C.description)&&(0,n.jsx)(c.$Z,{editor:J,className:"tiptap-editor"})}):(0,n.jsx)("div",{className:"mt-12 flex flex-col justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-4xl font-semibold",children:"B\xecnh luận"}),(0,n.jsx)("div",{className:"space-y-6 py-6 mb-[150px]",children:L.length>0?L.map((e,t)=>{var r,a;return(0,n.jsx)(y.LB,{index:t,commentsLength:L.length,commentID:e.commentID,userID:e.userID,avatar:(null==(r=e.user)?void 0:r.avatar)||"",name:(null==(a=e.user)?void 0:a.username)||"User ".concat(e.userID),date:new Date(e.commentAt).toLocaleDateString(),comment:e.content,likeCount:e.likeCount,dislikeCount:e.dislikeCount,onLike:()=>Q(e.commentID),onDislike:()=>W(e.commentID),reFetchComments:Z,rating:e.rating,type:"product"},t)}):(0,n.jsx)("div",{className:"text-gray-500 py-4",children:"Chưa c\xf3 b\xecnh luận n\xe0o."})})]})})})]})]}),(0,n.jsx)("div",{className:"w-full mt-12 border-t-1 border-primary/10 pt-8",children:(0,n.jsxs)("div",{className:"max-w-5xl mx-auto",children:[" ",(0,n.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Sản phẩm li\xean quan"}),K.length>0?(0,n.jsxs)(b.FN,{className:"relative w-full",children:[(0,n.jsx)(b.Wk,{children:K.map(e=>{var t;return(0,n.jsx)(b.A7,{className:"max-w-xs",children:(0,n.jsx)(I.default,{productID:e.productID,productName:e.productName,image:(null==(t=e.images)?void 0:t[0])||"",title:e.productName,discountPrice:e.productPriceSale?e.productPriceSale:0,price:e.productPrice,rating:e.rating})},e.productID)})}),(0,n.jsx)(b.Q8,{variant:"normal",className:"flex justify-center items-center"}),(0,n.jsx)(b.Oj,{variant:"normal",className:"flex justify-center items-center"})]}):(0,n.jsx)("div",{className:"w-full h-40 flex items-center justify-center text-gray-600",children:"Kh\xf4ng c\xf3 sản phẩm li\xean quan"})]})})]}),(0,n.jsx)(D.P.div,{initial:{y:120},animate:O?{y:0}:{y:120},transition:{type:"spring",stiffness:300,damping:30},style:{position:"fixed",bottom:0,left:0,width:"100%",zIndex:90},children:(0,n.jsx)("div",{className:"bg-white rounded-tr-xl rounded-tl-xl shadow-[var(--add-to-cart-panel-shadow)] border-t border-gray-200",children:(0,n.jsx)(y.zw,{productImage:C&&C.images?C.images[0]:"",productName:C.productName,productID:C.productID})})})]}):(0,n.jsx)("div",{className:"p-8 text-red-500",children:"Kh\xf4ng t\xecm thấy sản phẩm."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7935,6122,5004,277,4277,3568,6231,1350,6766,56,1193,7625,2727,6874,4754,8037,4297,5692,1787,8612,5957,8441,1684,7358],()=>t(43177)),_N_E=e.O()}]);