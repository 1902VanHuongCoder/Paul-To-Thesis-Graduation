(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6720],{17562:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>V});var l=n(95155),c=n(25957),a=n(41283),i=n(35695),s=n(12115),h=n(66766),m=n(75109),r=n(24932),d=n(17e3),o=n(36761),u=n(81891),g=n(84109),b=n(60882),x=n(61261),v=n(91924),j=n(24106),f=n(95621),A=n(63356),k=n(26333),p=n(40951),y=n(90192),w=n(43557),N=n(79030),z=n(423),D=n(67938),I=n(43332),C=n(52672),S=n(26420),B=n(89179);let E={src:"/_next/static/media/rice-and-leaf.40fa250b.png",height:200,width:151,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAMAAADtGH4KAAAAUVBMVEVMaXH9xCr7xSsToEz8xir9xijzwyz6wyv3wir6xCpqqT0foUopnUXLwTVbrT+KrTvDvjTzwCvSvDHfvzAJnE/ivy72wyybtDl+rTx0uUPizjZXZfh0AAAAGXRSTlMAt/OnJDjlz3pqldw3gBxexp70aVOYVqTDeJ4sEAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADdJREFUeJwFwQkCwBAMAMGlSKKHXij/f2hnIEhgI2qyvKL+8mPB3HOPF5M6P1DX5w5NzhQBygE/Mf4B1bOG79kAAAAASUVORK5CYII=",blurWidth:6,blurHeight:8};var T=n(88853),L=n(13568),U=n(47123),M=n(17127);function V(){let{newsID:t}=(0,i.useParams)(),e=(0,i.useRouter)(),{lang:n}=(0,a.K)(),{user:V}=(0,B.J)(),[_,F]=(0,s.useState)(null),[O,G]=(0,s.useState)([]),[H,J]=(0,s.useState)([]),[K,q]=(0,s.useState)(!0),[P,R]=(0,s.useState)(""),[X,Y]=(0,s.useState)(!1),$=(0,s.useRef)(null),Q=(0,m.hG)({extensions:[r.A,d.A,o.Ay,u.Ay,x.Ay,v.A,j.A,f.A,A.A,p.A,k.Ay.configure({nested:!0}),b.A.configure({levels:[1,2,3,4,5,6],HTMLAttributes:{class:"text-gray-900 dark:text-white font-bold"}}),g.A.configure({types:["heading","paragraph"]}),D.A,y.Ay.configure({resizable:!0}),z.A,N.h,w.A],content:"<p>Loading...</p>",editable:!1}),Z=async t=>{if(t.preventDefault(),P.trim()&&_&&V){if(O.some(t=>t.userID===V.userID))return void L.Ay.error("Bạn đ\xe3 b\xecnh luận về b\xe0i viết n\xe0y rồi!");Y(!0);try{if((0,T.D)(P.trim()))return void L.Ay.error("B\xecnh luận của bạn chứa từ ngữ kh\xf4ng ph\xf9 hợp!");let t=await (0,U.P)(_.newsID,V.userID,P.trim());if(t){var e;L.Ay.success("B\xecnh luận đ\xe3 được gửi th\xe0nh c\xf4ng!"),R(""),null==(e=$.current)||e.focus(),G(e=>[t,...e])}}catch(t){console.error("Failed to submit comment:",t)}finally{Y(!1)}}},W=async t=>{if(_){G(O.map(e=>e.commentID===t?{...e,likeCount:e.likeCount+1}:e));try{if(!await (0,U.S7)(t))return void L.Ay.error("C\xf3 lỗi khi th\xedch b\xecnh luận n\xe0y! Vui l\xf2ng thử lại sau.")}catch(t){console.log(t)}}},tt=async t=>{if(_){G(O.map(e=>e.commentID===t?{...e,dislikeCount:e.dislikeCount+1}:e));try{if(!await (0,U.m)(t))return void L.Ay.error("C\xf3 lỗi khi kh\xf4ng th\xedch b\xecnh luận n\xe0y! Vui l\xf2ng thử lại sau.")}catch(t){console.log(t)}}},te=t=>{_&&G(O.filter(e=>e.commentID!==t))};return((0,s.useEffect)(()=>{let e=async()=>{try{let e=await (0,M.Yn)(),n=e.find(e=>e.newsID===Number(t));F(n||null),J(e.filter(e=>e.newsID!==Number(t))),null==Q||Q.commands.setContent(JSON.parse((null==n?void 0:n.content)||"{}"))}catch(t){console.error("Failed to fetch news detail:",t),F(null)}finally{q(!1)}},n=async()=>{if(t)try{let e=await (0,U.f3)(Number(t));G(e)}catch(t){console.error("Failed to fetch comments:",t)}};t&&(e(),n())},[t,Q]),K)?(0,l.jsx)(c.cW,{}):_?(0,l.jsxs)("div",{className:"py-10 px-6",children:[(0,l.jsx)(c.Qp,{items:[{label:"Trang chủ",href:"/"},{label:"Tin tức",href:"/".concat(n,"/homepage/news")},{label:_.title||"Chi tiết b\xe0i đăng"}]}),(0,l.jsxs)("div",{className:"relative grid grid-cols-[1fr_400px] gap-6",children:[(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto h-screen",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mt-6 mb-2",children:_.title}),_.hastags&&_.hastags.length>0&&(0,l.jsx)("div",{className:"mb-4 flex flex-wrap gap-2 ",children:_.hastags.map((t,e)=>(0,l.jsxs)("span",{className:"bg-blue-100 text-blue-700 p-2 rounded text-sm flex items-center gap-x-1",children:[(0,l.jsx)("span",{children:(0,l.jsx)(I.A,{height:18})}),(0,l.jsx)("span",{children:t.tagName})]},e))}),_.titleImageUrl&&(0,l.jsx)(h.default,{width:800,height:400,src:_.titleImageUrl||E,alt:_.title,className:"w-full max-h-96 object-cover rounded mb-4"}),_.subtitle&&(0,l.jsx)("div",{className:"text-lg text-gray-600 mb-6",children:_.subtitle}),(0,l.jsx)("div",{className:"prose prose-blue max-w-4xl mx-auto tiptap-content mb-8 ",children:(null==_?void 0:_.content)&&(0,l.jsx)(m.$Z,{editor:Q,className:"tiptap-editor"})})]}),(0,l.jsxs)("div",{className:"shrink-0 sticky top-0 h-fit",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Những b\xe0i viết kh\xe1c"}),(0,l.jsx)("div",{className:"grid gap-4",children:H.slice(0,5).map(t=>(0,l.jsxs)("div",{className:"p-4 border rounded hover:bg-gray-100 cursor-pointer flex gap-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-20 h-20",children:(0,l.jsx)(h.default,{width:100,height:100,src:t.titleImageUrl||E,alt:t.title,className:"object-cover rounded w-full h-full"})}),(0,l.jsxs)("div",{className:"",children:[(0,l.jsx)("div",{className:"font-bold w-[280px] truncate",children:t.title}),(0,l.jsx)("div",{className:"text-sm w-[280px] truncate text-gray-500",children:t.subtitle}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleDateString()}),(0,l.jsx)(S.$,{variant:"link",className:"cursor-pointer px-0",onClick:()=>e.push("/".concat(n,"/homepage/news/").concat(t.newsID)),children:"Xem chi tiết"})]})]},t.newsID))})]})]}),(0,l.jsx)("hr",{className:"my-8"}),(0,l.jsxs)("div",{className:"mt-8 max-w-7xl mx-auto",children:[(0,l.jsx)("h2",{className:"text-4xl font-semibold mb-4",children:"B\xecnh luận về b\xe0i viết"}),(0,l.jsxs)("form",{onSubmit:Z,className:"mb-6 flex flex-col gap-2 items-end",children:[(0,l.jsx)(C.T,{ref:$,className:"min-h-[200px]",placeholder:"Nhập b\xecnh luận của bạn...",value:P,onChange:t=>R(t.target.value),disabled:X,rows:8}),(0,l.jsx)(S.$,{type:"submit",className:"bg-primary text-white px-4 py-2 rounded w-fit cursor-pointer ",disabled:X||!P.trim(),children:X?"Đang gửi b\xecnh luận...":"Gửi b\xecnh luận"})]}),(0,l.jsx)("div",{className:"space-y-6",children:_&&O.length>0?O.map((t,e)=>{var n,a;return(0,l.jsx)(c.LB,{commentID:t.commentID,index:e,commentsLength:O.length,userID:t.userID,avatar:(null==(n=t.user_comments)?void 0:n.avatar)||E,name:(null==(a=t.user_comments)?void 0:a.username)||"Người d\xf9ng ".concat(t.userID),date:new Date(t.commentAt).toLocaleDateString(),comment:t.content,likeCount:t.likeCount,dislikeCount:t.dislikeCount,onLike:()=>W(t.commentID),onDislike:()=>tt(t.commentID),reFetchComments:()=>te(t.commentID),type:"news"},t.commentID)}):(0,l.jsx)("div",{className:"text-gray-500",children:"Chưa c\xf3 b\xecnh luận n\xe0o cho b\xe0i đăng n\xe0y."})})]}),(0,l.jsx)(c.Hw,{})]}):(0,l.jsx)("div",{children:"B\xe0i đăng kh\xf4ng tồn tại."})}},58806:(t,e,n)=>{Promise.resolve().then(n.bind(n,17562))},88853:(t,e,n)=>{"use strict";n.d(e,{D:()=>c});let l=["địt","cặc","lồn","đụ","ch\xf3","ngu","đ\xe9o","v\xe3i","fuck","shit","bitch","dcm","dm","cc","ml","đĩ","bố m\xe0y","b\xe0 m\xe0y","mẹ m\xe0y","bố nh\xe0 m\xe0y","b\xe0 nh\xe0 m\xe0y","mẹ nh\xe0 m\xe0y","bố đời","b\xe0 đời","mẹ đời","khốn nạn","khốn kiếp","r\xe1c rưởi","bẩn thỉu","bựa","bựa v\xe3i","bựa qu\xe1","bựa thật","bựa vl","vkl","vcl","vcc","vđ","v\xe3i l","v\xe3i c","v\xe3i đ\xe1i","v\xe3i h\xe0ng","v\xe3i chưởng","v\xe3i cả lồn","v\xe3i cả c","\xf3c ch\xf3","\xf3c lợn","\xf3c heo","n\xe3o phẳng","n\xe3o t\xe0n","n\xe3o c\xe1 v\xe0ng","n\xe3o ngắn","n\xe3o ch\xf3","n\xe3o b\xf2","thằng ngu","con ngu","thằng ch\xf3","con ch\xf3","thằng đi\xean","con đi\xean","thằng kh\xf9ng","con kh\xf9ng","thằng rồ","con rồ","thằng dở","con dở","thằng dở hơi","con dở hơi","thằng thần kinh","con thần kinh","mẹ kiếp","bố l\xe1o","l\xe1o to\xe9t","l\xe1o lếu","l\xe1o nh\xe1o","l\xe1o xược","l\xe1o c\xe1","l\xe1o to\xe9t","ph\xf2","g\xe1i gọi","g\xe1i b\xe1n hoa","g\xe1i điếm","g\xe1i bao","g\xe1i mại d\xe2m","trai bao","trai gọi","đồ ngu","đồ ch\xf3","đồ đi\xean","đồ kh\xf9ng","đồ rồ","đồ dở","đồ thần kinh","đồ bẩn","đồ r\xe1c","bẩn bựa","bẩn thỉu","bẩn kinh","bẩn kinh khủng","bẩn kinh dị","bẩn kinh tởm","đồ khốn","đồ khốn nạn","đồ khốn kiếp","đồ r\xe1c rưởi","đồ bẩn thỉu","đm","vkl","vcl","cl","cc","dmm","dmml","dcm","dmm","dcmml","dmmml","djt","djt me","djt m","djt con me","djt bo","djt ba","djt cha","djt cau","djt cau ba","djt cau me","c*k","c@k","cak","cak*","cak@","cak#","cak!","cak1","cak3","cak5","cak9","l*n","l@n","lon","l0n","l0*n","l*n","l*n1","l*n3","l*n5","l*n9","cho","cho#","ch0","ch0#","ch0!","ch0*","ch0@","ch0^","ch0$","ch0%","nguu","ngụ","nguuu","nguuuu","ngụu","ngụuu","ngụuuu","nguu~","ngụ~","v~l","v~c","v~d","v~kl","v~cl","v~cc","v~đ","v~ai","v~ai l","v~ai c","djt","djt m","djt me","djt cha","djt ba","djt bo","djt cau","djt cau ba","djt cau me","djtmm","djtcm","djtcc","djtcl","djtvl","djtvc","djtvd","djtvkl","djtvcl","dmm","dmml","dcm","dmm","dcmml","dmmml","dm m","dm me","dm cha","dm ba","dm bo","djt*","djt@","djt#","djt!","djt1","djt3","djt5","djt9","clm","clml","clmm","clmlm","clmmml","clmmmlm","clmmmlmm","clmmmlmmm","l0z","l0zz","l0zzz","l0zzzz","l0zzzzz","l0zzzzzz","l0zzzzzzz","l*n","l@n","l*n1","l*n3","l*n5","l*n9","l@n1","l@n3","l@n5","l@n9","sh!t","sh1t","shlt","sh*t","sh@t","sh#t","sh!t!","sh1t1","shlt1","sh*t1","f*ck","f@ck","f#ck","f!ck","f1ck","f*ck1","f@ck1","f#ck1","f!ck1","f1ck1","b!tch","b1tch","b*tch","b@tch","b#tch","b!tch1","b1tch1","b*tch1","b@tch1","b#tch1"];function c(t){let e=t.toLowerCase().normalize("NFC");return l.some(t=>e.includes(t))}}},t=>{var e=e=>t(t.s=e);t.O(0,[7935,6122,5004,277,4277,3568,6231,1350,6766,56,1193,7625,2727,6874,4754,8037,4297,5692,1787,8612,5957,8441,1684,7358],()=>e(58806)),_N_E=t.O()}]);