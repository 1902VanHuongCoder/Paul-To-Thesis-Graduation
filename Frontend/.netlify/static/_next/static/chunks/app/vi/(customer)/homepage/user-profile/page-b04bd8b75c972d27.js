(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2105],{18587:(e,r,s)=>{Promise.resolve().then(s.bind(s,48967))},48967:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>x});var a=s(95155),n=s(89179),i=s(70902),l=s(12115),t=s(25957),c=s(13568),d=s(74824),o=s(26420),h=s(23043),u=s(89736);function x(){var e,r;let{user:s,logout:x}=(0,n.J)(),[m,p]=(0,l.useState)([]),[b,f]=(0,l.useState)(!0),[g,y]=(0,l.useState)(!1),[v,j]=(0,l.useState)({province:"",district:"",ward:"",detailAddress:"",phone:"",isDefault:!1}),[N,w]=(0,l.useState)([]),[D,k]=(0,l.useState)([]),[C,I]=(0,l.useState)([]),[A,E]=(0,l.useState)(!1),[T,S]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{if(null==s?void 0:s.userID)try{let e=await (0,h.KQ)(s.userID);p(e)}catch(e){p([])}finally{f(!1)}})()},[null==s?void 0:s.userID,g]),(0,l.useEffect)(()=>{let e=async()=>{try{let e=await (0,u.tN)();w(e)}catch(e){console.error("Error fetching provinces:",e)}};g&&e()},[g]),(0,l.useEffect)(()=>{if(!v.province){k([]),I([]);return}let e=N.find(e=>e.name===v.province),r=async e=>{try{let r=await (0,u.Fi)(e);k(r)}catch(e){console.error("Error fetching districts:",e)}};e&&r(e.code)},[v.province,N]),(0,l.useEffect)(()=>{if(!v.district)return void I([]);let e=D.find(e=>e.name===v.district),r=async e=>{try{let r=await (0,u.RI)(e);I(r)}catch(e){console.error("Error fetching wards:",e)}};e&&r(e.code)},[v.district,D]);let q=async e=>{if(!s)return void c.Ay.error("Bạn cần đăng nhập để thực hiện thao t\xe1c n\xe0y.");try{await (0,h.cI)({shippingAddressID:e,userID:s.userID});let r=m.map(r=>r.shippingAddressID===e?{...r,isDefault:!0}:{...r,isDefault:!1});p(r)}catch(e){console.error("Error setting default address:",e),c.Ay.error("Xay ra lỗi khi đặt địa chỉ l\xe0m mặc định.")}},B=async e=>{if(e.preventDefault(),!s)return void c.Ay.error("Bạn cần đăng nhập để th\xeam địa chỉ.");E(!0),S("");try{let e="".concat(v.detailAddress,", ").concat(v.ward,", ").concat(v.district,", ").concat(v.province);await (0,h.eQ)({userID:s.userID,address:e,phone:v.phone,isDefault:v.isDefault}),y(!1),j({province:"",district:"",ward:"",detailAddress:"",phone:"",isDefault:!1}),S("Th\xeam địa chỉ th\xe0nh c\xf4ng!")}catch(e){console.error("Error adding address:",e),S(e instanceof Error?e.message:"Đ\xe3 xảy ra lỗi khi th\xeam địa chỉ.")}finally{E(!1)}},Q=async e=>{if(!s)return void c.Ay.error("Bạn cần đăng nhập để x\xf3a địa chỉ.");if(confirm("Bạn c\xf3 chắc muốn x\xf3a địa chỉ n\xe0y?"))try{await (0,h.Yz)(e,s.userID),f(!0);let r=await (0,h.KQ)(s.userID);p(r)}catch(e){console.log(e),c.Ay.error("X\xf3a địa chỉ thất bại, h\xe3y thử lại sau.")}};return s?(0,a.jsxs)("div",{className:"px-6 py-10",children:[(0,a.jsx)(t.Qp,{items:[{label:"Trang chủ",href:"/"},{label:"T\xe0i khoản của bạn"}]}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)(i.eu,{className:"size-24 border-2 border-primary/30",children:s.avatar?(0,a.jsx)(i.BK,{src:s.avatar,alt:s.username,className:"object-cover border-[2px] border-primary"}):(0,a.jsx)(i.q5,{className:"border-[1px] border-gray-300 text-3xl",children:(null==(r=s.username)||null==(e=r[0])?void 0:e.toUpperCase())||"U"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-5xl font-bold",children:s.username}),(0,a.jsx)("div",{className:"text-gray-500 text-lg",children:s.email})]}),(0,a.jsx)("button",{className:"px-6 py-2 bg-primary text-white rounded hover:bg-primary/90 transition cursor-pointer",onClick:x,children:"Đăng xuất"})]}),(0,a.jsx)("hr",{className:"border-[1px] border-gray-100 w-full my-8"}),(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:g?"Nhập th\xf4ng tin địa chỉ mới":"Danh s\xe1ch địa chỉ giao h\xe0ng của bạn"}),(0,a.jsx)("button",{className:" text-primary px-4 py-2 rounded border-1 border-primary  hover:bg-primary hover:text-white transition cursor-pointer",onClick:()=>y(e=>!e),children:g?"Đ\xf3ng":"Th\xeam địa chỉ mới"})]}),g&&(0,a.jsxs)("form",{onSubmit:B,className:"space-y-3 my-7 border-[1px] border-gray-200 p-6 rounded-lg bg-white",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-normal text-sm text-black/40",children:"Tỉnh/Th\xe0nh phố"}),(0,a.jsxs)(d.l6,{value:v.province,onValueChange:e=>j(r=>({...r,province:e,district:"",ward:""})),required:!0,disabled:0===N.length,children:[(0,a.jsx)(d.bq,{className:"w-full px-4 py-6 rounded-full border border-gray-300 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus:bg-white",children:(0,a.jsx)(d.yv,{placeholder:"Chọn tỉnh/th\xe0nh phố"})}),(0,a.jsx)(d.gC,{className:"max-h-60",children:(0,a.jsxs)(d.s3,{children:[(0,a.jsx)(d.TR,{children:"Tỉnh/Th\xe0nh phố"}),N.map(e=>(0,a.jsx)(d.eb,{value:e.name,children:e.name},e.code))]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-normal text-sm text-black/40",children:"Quận/Huyện"}),(0,a.jsxs)(d.l6,{value:v.district,onValueChange:e=>j(r=>({...r,district:e,ward:""})),required:!0,disabled:!v.province,children:[(0,a.jsx)(d.bq,{className:"w-full px-4 py-6 rounded-full border border-gray-300 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus:bg-white",disabled:!v.province,children:(0,a.jsx)(d.yv,{placeholder:"Chọn quận/huyện"})}),(0,a.jsx)(d.gC,{className:"max-h-60",children:(0,a.jsxs)(d.s3,{children:[(0,a.jsx)(d.TR,{children:"Quận/Huyện"}),D.map(e=>(0,a.jsx)(d.eb,{value:e.name,children:e.name},e.code))]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-normal text-sm text-black/40",children:"Phường/X\xe3"}),(0,a.jsxs)(d.l6,{value:v.ward,onValueChange:e=>j(r=>({...r,ward:e})),required:!0,disabled:!v.district,children:[(0,a.jsx)(d.bq,{className:"w-full px-4 py-6 rounded-full border border-gray-300 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus:bg-white",disabled:!v.district,children:(0,a.jsx)(d.yv,{placeholder:"Chọn phường/x\xe3"})}),(0,a.jsx)(d.gC,{className:"max-h-60",children:(0,a.jsxs)(d.s3,{children:[(0,a.jsx)(d.TR,{children:"Phường/X\xe3"}),C.map(e=>(0,a.jsx)(d.eb,{value:e.name,children:e.name},e.code))]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-normal text-sm text-black/40",children:"Địa chỉ cụ thể"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 rounded-full border border-gray-300 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus:bg-white",value:v.detailAddress,onChange:e=>j(r=>({...r,detailAddress:e.target.value})),required:!0,placeholder:"Nhập số nh\xe0, t\xean đường..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-normal text-sm text-black/40",children:"Số điện thoại"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-3 rounded-full border border-gray-300 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus:bg-white",value:v.phone,onChange:e=>j(r=>({...r,phone:e.target.value})),required:!0,placeholder:"Nhập số điện thoại"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"isDefault",checked:v.isDefault,onChange:e=>j(r=>({...r,isDefault:e.target.checked})),className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"isDefault",children:"Đặt l\xe0m địa chỉ mặc định"})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(o.$,{variant:"default",size:"lg",type:"submit",className:"bg-primary text-white py-2 rounded font-semibold hover:bg-green-700 transition cursor-pointer",disabled:A,children:A?"Đang lưu...":"Th\xeam địa chỉ"})}),T&&(0,a.jsx)("div",{className:"text-center text-sm mt-2",children:T})]}),b?(0,a.jsx)("div",{children:"Đang tải danh s\xe1ch địa chỉ..."}):0===m.length?(0,a.jsx)("div",{children:"Bạn chưa c\xf3 địa chỉ giao h\xe0ng n\xe0o."}):(0,a.jsx)("ul",{className:"space-y-4",children:m.map(e=>(0,a.jsx)("li",{className:"relative bg-white p-4 rounded flex flex-col justify-between items-start ".concat(e.isDefault?"border-primary-hover border-[1px]":"border-gray-200 border-[1px]"," hover:shadow-xl transition shadow-gray-100"),children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"font-medium",children:e.address}),(0,a.jsxs)("div",{className:"text-gray-600",children:["SĐT: ",e.phone]}),e.isDefault&&(0,a.jsxs)("span",{className:"flex items-center gap-x-2 text-gray-400 absolute top-5 right-5",children:[(0,a.jsx)("span",{className:"w-[10px] h-[10px] bg-green-500 rounded-full"}),(0,a.jsx)("span",{children:"Mặc định"})]}),(0,a.jsxs)("div",{className:"flex gap-x-2 justify-end w-full",children:[!e.isDefault&&(0,a.jsx)("button",{className:"mt-4 px-3 py-1 border-1 border-primary hover:text-white hover:bg-primary text-primary rounded cursor-pointer transition-all",onClick:()=>q(e.shippingAddressID),children:"Đặt l\xe0m mặc định"}),(0,a.jsx)("button",{className:"mt-4 px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 cursor-pointer",onClick:()=>Q(e.shippingAddressID),children:"X\xf3a"})]})]})},e.shippingAddressID))})]})]})]}):(0,a.jsxs)("div",{className:"max-w-xl mx-auto py-16 text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Bạn chưa đăng nhập"}),(0,a.jsx)("p",{children:"Vui l\xf2ng đăng nhập để xem th\xf4ng tin c\xe1 nh\xe2n."})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[7935,6122,4277,3568,6231,1350,6766,56,1193,7625,2727,6874,4754,8037,4297,8612,5957,8441,1684,7358],()=>r(18587)),_N_E=e.O()}]);